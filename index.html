<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>ESP32-S3 Live Location Sender</title>
  <style>
    body { font-family: 'Poppins', sans-serif; text-align:center; background:#121212; color:white; }
    button { background:red; color:white; border:none; padding:15px 25px; border-radius:10px; font-size:18px; cursor:pointer; margin-top:40px; }
    button:hover { background:darkred; }
  </style>
</head>
<body>
  <h1>📍 ESP32-S3 Live Location Sender</h1>
  <p>Tap the button below to send your current location to ESP32-S3</p>
  <input type="text" id="espIP" placeholder="Enter ESP IP (e.g. 192.168.0.103)" style="padding:10px; width:80%; border-radius:8px; margin-top:10px;"><br>
  <button onclick="sendLocation()">📡 Send Location</button>

  <p id="status" style="margin-top:20px;"></p>

  <script>
    function sendLocation() {
      const espIP = document.getElementById('espIP').value.trim();
      if (!espIP) return alert("Enter your ESP IP address first!");

      navigator.geolocation.getCurrentPosition(pos => {
        const lat = pos.coords.latitude.toFixed(6);
        const lon = pos.coords.longitude.toFixed(6);

        const url = `http://${espIP}/update?lat=${lat}&lon=${lon}`;
        document.getElementById("status").innerText = "📡 Sending location...";

        fetch(url)
          .then(res => res.text())
          .then(data => document.getElementById("status").innerText = "✅ Sent! ESP updated successfully.")
          .catch(err => document.getElementById("status").innerText = "❌ Failed: " + err);
      }, err => {
        document.getElementById("status").innerText = "❌ Location permission denied!";
      });
    }
  </script>
</body>
</html>
